# FlattenTable

## 项目简介
FlattenTable 是一个专业的数据预处理工具，用于将二维交叉表格转化为一维规范化表格。该工具主要解决以下问题：

1. **数据结构规范化**：将包含行标题、列标题和数值区域的二维表格，转化为数据库友好的"键-值"结构
2. **分析友好格式**：输出结果可直接用于Pandas数据处理、SQL数据库导入或BI工具分析
3. **自动化处理**：批量处理多sheet或多文件场景，提升数据准备效率

## 示例
**二维表格的示例如下，你需要按照该示例内容，准备xlsx格式的Excel文件，可参考example文件夹下的示例文件。**

**输入：二维表格（典型财务数据格式）**
| 项目       | 2020 | 2021 | 2022 |
|------------|----------------|----------------|----------------|
| 短期借款   | 500            | 600            | 550            |
| 长期借款   | 1000           | 1200           | 1500           |
| 应付账款   | 300            | 400            | 450            |
| 总负债     | 1800           | 2200           | 2500           |

**输出：一维规范化表格**
| 项目       | 年份   | 金额 |
|------------|--------|--------------|
| 短期借款   | 2020   | 500          |
| 短期借款   | 2021   | 600          |
| 短期借款   | 2022   | 550          |
| ...   | ...   | ...         |
| 总负债     | 2021   | 2200         |
| 总负债     | 2022   | 2500         |


## 快速开始
### 环境准备（可选步骤）

```
conda create -n flattentable python=3.12
conda activate flattentable
```

### 安装必要库
```
pip install pandas openpyxl
```

### 获取项目代码
```
git clone https://github.com/CurioChen77/FlattenTable.git
cd FlattenTable/main
```

### 执行转换程序
```
python excel_converter.py
```

### 交互式操作指引
#### 输入文件路径
```
示例输入：/path/to/your/file.xlsx
```
程序将在`output`目录自动创建带时间戳和UUID的文件夹，原始文件与转换结果将一并保存。

#### 设置输出列名
按提示依次定义转换后的列名称：
```
第一列名称（原行标题）→ Project
第二列名称（原列标题）→ Year 
第三列名称（数据值）→ Value
```

#### 完成提示
成功转换后将显示结果路径：
```
转换完成！输出文件：output/20250423_210823_6941b353/Demo001_converted.xlsx
```

## 致谢

感谢以下项目与开发者为本工具提供支持：  
- **[Pandas](https://pandas.pydata.org/)** 
- **[OpenPyXL](https://openpyxl.readthedocs.io/)** 
- **[Python](https://www.python.org/)**

欢迎贡献代码或提出改进建议！  

## License  
本项目采用 **MIT License**, 完整许可条款见 [LICENSE](LICENSE) 文件。  

